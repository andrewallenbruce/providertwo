#' @name arguments
#'
#' @title Argument Classes
#'
#' @param x `<chr>` input vector
#'
#' @returns An S7 `<arg>` object.
#'
#' @examples
#' arg_npi("1225701881")
#' arg_npi(1225701881)
#' arg_npi(npi_ex$k)
#' arg_npi(NULL)
#' arg_npi(NA_character_)
#'
#' try(arg_npi(122570188))
#' try(arg_npi("12257O1881"))
#' try(arg_npi(1225701882))
#'
#' arg_state("CA")
#' arg_state(state.abb[1])
#' arg_state(state.abb)
#' arg_state(NA_character_)
#' arg_state(c(NULL, NULL))
#'
#' # Allow duplicates?
#' arg_state(c("CA", "CA"))
#' try(arg_state("C"))
#' try(arg_state("AA"))
#' @noRd
NULL

#' @autoglobal
#' @rdname arguments
#' @noRd
arg_npi <- new_class(
  name    = "arg_npi",
  package = NULL,
  properties = list(
    x = new_property(
      class = new_union(NULL, class_character),
      setter = function(self, value) {
        self@x <- as.character(value[which_not_na(value)])
        self
      },
      getter = function(self) {
        as.character(self@x[which_not_na(self@x)])
      }
    ),
    op = new_property(
      class = class_character,
      default = "=",
      getter = function(self)
        if (length(self@x) > 1) "IN" else "=")
  ),
  validator = function(self) {
    if (not_null(self@x) && length(self@x) > 0) {
      assert_nchars(self@x, 10L, "npi")
      assert_digits(self@x)
      assert_luhn(self@x)
    }
  }
)

#' @autoglobal
#' @rdname arguments
#' @noRd
arg_state <- new_class(
  name    = "arg_state",
  package = NULL,
  properties = list(
    x = new_property(
      class = new_union(NULL, class_character),
      setter = function(self, value) {
        self@x <- as.character(value[which_not_na(value)])
        self
      },
      getter = function(self) {
        as.character(self@x[which_not_na(self@x)])
      }
    ),
    op = new_property(
      class = class_character,
      default = "=",
      getter = function(self)
        if (length(self@x) > 1) "IN" else "=")
  ),
  validator = function(self) {
    if (not_null(self@x) && length(self@x) > 0) {
      assert_nchars(self@x, 2L, "state")
      assert_choices(self@x, state.abb, "state")
    }
  }
)

#' @name npi_ex
#' @title Example NPIs
#' @autoglobal
#' @keywords internal
#' @export
npi_ex <- list(
  k = c(
    1225701881,
    1174270805,
    1235702796,
    1962116806,
    1013647569,
    1306500665,
    1982296737,
    1083295638,
    1841967825,
    1891390084,
    1275117269,
    1992338701,
    1891355863,
    1548743511,
    1023473279,
    1861857013,
    1689182859,
    1982059275
  ),
  v = c(
    1083618052,
    1144224197,
    1891035663,
    1932882164,
    1770346785,
    1619089125,
    1437111069,
    1972581767,
    1063067940,
    1700146107,
    1164711313,
    1205695301,
    1114770625,
    1649710708,
    1720633803,
    1366158446,
    1740970649,
    1831194760,
    1568522639,
    1568769479,
    1477989747,
    1538143987,
    1447766738,
    1790292589,
    1245925544,
    1023219672,
    1366610990,
    1225050115,
    1790911337,
    1386074680,
    1164426136,
    1962406918,
    1104362359,
    1487632246,
    1710658042,
    1134828551,
    1043900723,
    1730224205,
    1841452505,
    1689786055,
    1841269891,
    1033675467,
    1265020358,
    1962717272,
    1972575983,
    1629639455,
    1730447467,
    1902295348,
    1720027014,
    1942347919,
    1184606824,
    1356453914,
    1124280862,
    1043616444,
    1821656562,
    1194795401,
    1952701641,
    1497172787,
    1912643768,
    1033979380,
    1386473395,
    1164972972,
    1144535840,
    1770781395,
    1891874939,
    1053453449,
    1306854922,
    1932416252,
    1225066780,
    1508917360,
    1497491138,
    1962498964,
    1720233034,
    1922243476,
    1851532055,
    1003050030,
    1679708010,
    1922261254,
    1689957862,
    1730463514,
    1144665837,
    1407291024,
    1699224527,
    1023158763,
    1154446862,
    1154440014,
    1316522659,
    1366117186,
    1619629839,
    1568112738,
    1225651540,
    1215505169,
    1942870241,
    1134673304,
    1891202388,
    1982103420,
    1568100113,
    1215741152,
    1104621929,
    1306679345,
    1205338712,
    1609373133,
    1609367556,
    1417209149,
    1316299662,
    1336484971,
    1194061382,
    1275871022,
    1821706060,
    1083068498,
    1194170712,
    1114475241,
    1619425550,
    1740980267,
    1275220345,
    1902893290,
    1043097884,
    1952182784,
    1205873700,
    1710929229,
    1134232937,
    1396910337,
    1811005655,
    1083805345,
    1689862757,
    1205804622,
    1003038720,
    1346326048,
    1790861441,
    1083793764,
    1932273653,
    1750446506,
    1295883957,
    1801887161,
    1326651910,
    1962017368,
    1801498191,
    1417559709,
    1528359882,
    1588946271,
    1114239779,
    1477032563,
    1487119756,
    1972068245,
    1982169777,
    1215473467,
    1497296529,
    1023652948,
    1487289674,
    1154940203,
    1366414138,
    1780489377,
    1699013144,
    1972790822,
    1629359708,
    1447533633,
    1962726687,
    1578696654,
    1619713666,
    1912738774,
    1750109898,
    1891544029,
    1356180939,
    1285983734,
    1376893131,
    1801131859,
    1053657296,
    1104241975,
    1790105989,
    1649689712,
    1023532280,
    1770092793,
    1689188906,
    1851890115,
    1831698190,
    1902194038,
    1245910439,
    1841972288,
    1497533319,
    1386423457,
    1306520283,
    1225607187,
    1497428213,
    1437235199,
    1851477558,
    1750467452,
    1417033119,
    1013449115,
    1558895961,
    1265834246,
    1992277552,
    1467004507,
    1821641432,
    1407591167,
    1932814373,
    1619674272,
    1457053027,
    1538861653,
    1417613407,
    1447916333,
    1649921610,
    1770294407,
    1235842568,
    1548297195,
    1124053947,
    1861419426,
    1306034475,
    1184805400,
    1174704837,
    1386703270,
    1205999133,
    1447492582,
    1306071527,
    1457583890,
    1588854061,
    1124003587,
    1447367453,
    1497104871,
    1093268203,
    1285182030,
    1467901470,
    1124563325,
    1225576176,
    1366880601,
    1922437649,
    1346679537,
    1811474828,
    1316421258,
    1710461322,
    1891384079,
    1073198099,
    1316573934,
    1558979278,
    1679039929,
    1982161774,
    1598227225,
    1477198117,
    1912544081,
    1679105027,
    1679541098,
    1508825175,
    1215990510,
    1548224413,
    1447261243,
    1043215759,
    1063456846,
    1326250036,
    1487120572,
    1508332438,
    1558834762,
    1558834671,
    1669937934,
    1538626536,
    1386107738,
    1750844015,
    1093379786,
    1790347185,
    1609423078,
    1447800529,
    1134770357,
    1518595339,
    1497534085,
    1790551307,
    1962017848,
    1649887431,
    1528668175,
    1033607817,
    1235618851,
    1043922578,
    1538898911,
    1275269490,
    1588179345,
    1477851038,
    1780970335,
    1689008534,
    1942019690,
    1811709884,
    1699367649,
    1225622459,
    1568047587,
    1053996611,
    1093483349,
    1689497323,
    1346080405,
    1720363732,
    1962020958,
    1093323982,
    1316610132,
    1306519129,
    1417621475,
    1427615871,
    1346790946,
    1003699240,
    1962190892,
    1447336185,
    1699851337,
    1932200995,
    1679625214,
    1285763383,
    1033234315,
    1801098470,
    1457554131,
    1306024237,
    1659328805,
    1588606008,
    1639313661,
    1982697629,
    1790771004,
    1699703041,
    1720003262,
    1649542143,
    1598084386,
    1730492760,
    1619382850,
    1306254560,
    1578097937,
    1194252650,
    1669992731,
    1740706332,
    1790024859,
    1396085981,
    1710308101,
    1447677828,
    1629498571,
    1649520735,
    1780936815,
    1275877748,
    1083950463,
    1801133228,
    1902143878,
    1184961732,
    1811391592,
    1891095451,
    1609179928,
    1912204512,
    1255369435,
    1497782817,
    1548298839,
    1629177324,
    1649370339,
    1235215930,
    1639525470,
    1982157012,
    1821546623,
    1114475944,
    1184109118,
    1609695592,
    1285442566,
    1790590214,
    1861149387,
    1235870825,
    1063158855,
    1275256679,
    1205665866,
    1770314593,
    1215651716,
    1902523764,
    1154038867,
    1558078923,
    1477262590,
    1972814424,
    1174062210,
    1588266571,
    1922601335,
    1578228839,
    1053004770,
    1851084909,
    1174205694,
    1942061791,
    1407606387,
    1639920119,
    1265283790,
    1326897158,
    1851131130,
    1073509105,
    1417944513,
    1801887419,
    1174715718,
    1821031329,
    1073779260,
    1063667905,
    1336152230,
    1386707552,
    1629129390,
    1306990072,
    1437310588,
    1992818801,
    1922119247,
    1992802813,
    1215990098,
    1790734341,
    1013311968,
    1962892414,
    1821480799,
    1780970475,
    1659643286,
    1104198118,
    1467793000,
    1497181960,
    1689266710,
    1033701164,
    1497349435,
    1134701196,
    1487237525,
    1609411669,
    1336785914,
    1518590280,
    1457971921,
    1619587110,
    1902418031,
    1457966509,
    1285164780,
    1114437100,
    1376056366,
    1154826261,
    1821023649,
    1346550100,
    1063225795,
    1174352827,
    1710252135,
    1205261138,
    1992957229,
    1972693190,
    1841372984,
    1033292529,
    1083130686,
    1841054467,
    1982462545,
    1033978648,
    1649030313,
    1427805696,
    1083496996,
    1609645944,
    1730941428,
    1851951909,
    1053967430,
    1881240653,
    1821633801,
    1881079242,
    1073981239,
    1346611084,
    1710342589,
    1942902879,
    1598441446,
    1679987804,
    1992110597,
    1740913227,
    1063146561,
    1710388301,
    1508055708,
    1255417994,
    1871679571,
    1417033168,
    1548499940,
    1336850429,
    1568178408,
    1629774187,
    1386340628,
    1831777440,
    1104544162,
    1134871742,
    1225610280,
    1851961924,
    1851066963,
    1801562459,
    1720755077,
    1437817053,
    1184661126,
    1588619639,
    1841341500,
    1679778419,
    1134327927,
    1306916416,
    1346309242,
    1336203306,
    1164684304,
    1679000376,
    1588184659,
    1871832121,
    1801415351,
    1912528084,
    1841806841,
    1164038535,
    1982924635,
    1346552783,
    1811209208,
    1376034389,
    1154809408,
    1457647943,
    1205111952,
    1548736630,
    1700353547,
    1679047492,
    1104382092,
    1043776842,
    1285232777,
    1881294395,
    1790388007,
    1881281970,
    1588256614,
    1083618052,
    1144224197,
    1891035663,
    1932882164,
    1770346785,
    1619089125,
    1437111069,
    1972581767,
    1063067940,
    1700146107,
    1164711313,
    1205695301,
    1114770625,
    1649710708,
    1720633803,
    1366158446,
    1740970649,
    1831194760,
    1568522639,
    1568769479,
    1477989747,
    1538143987,
    1447766738,
    1790292589,
    1245925544,
    1023219672,
    1366610990,
    1225050115,
    1790911337,
    1386074680,
    1164426136,
    1962406918,
    1104362359,
    1487632246,
    1710658042,
    1134828551,
    1043900723,
    1730224205,
    1841452505,
    1689786055,
    1841269891,
    1033675467,
    1265020358,
    1962717272,
    1972575983,
    1629639455,
    1730447467,
    1902295348,
    1720027014,
    1942347919,
    1184606824,
    1356453914,
    1124280862,
    1043616444,
    1821656562,
    1194795401,
    1952701641,
    1497172787,
    1912643768,
    1033979380,
    1386473395,
    1164972972,
    1144535840,
    1770781395,
    1891874939,
    1053453449,
    1306854922,
    1932416252,
    1225066780,
    1508917360,
    1497491138,
    1962498964,
    1720233034,
    1922243476,
    1851532055,
    1003050030,
    1679708010,
    1922261254,
    1689957862,
    1730463514,
    1144665837,
    1407291024,
    1699224527,
    1023158763,
    1154446862,
    1154440014,
    1316522659,
    1366117186,
    1619629839,
    1568112738,
    1225651540,
    1215505169,
    1942870241,
    1134673304,
    1891202388,
    1982103420,
    1568100113,
    1215741152,
    1104621929,
    1306679345,
    1205338712,
    1609373133,
    1609367556,
    1417209149,
    1316299662,
    1336484971,
    1194061382,
    1275871022,
    1821706060,
    1083068498,
    1194170712,
    1114475241,
    1619425550,
    1740980267,
    1275220345,
    1902893290,
    1043097884,
    1952182784,
    1205873700,
    1710929229,
    1134232937,
    1396910337,
    1811005655,
    1083805345,
    1689862757,
    1205804622,
    1003038720,
    1346326048,
    1790861441,
    1083793764,
    1932273653,
    1750446506,
    1295883957,
    1801887161,
    1326651910,
    1962017368,
    1801498191,
    1417559709,
    1528359882,
    1588946271,
    1114239779,
    1477032563,
    1487119756,
    1972068245,
    1982169777,
    1215473467,
    1497296529,
    1023652948,
    1487289674,
    1154940203,
    1366414138,
    1780489377,
    1699013144,
    1972790822,
    1629359708,
    1447533633,
    1962726687,
    1578696654,
    1619713666,
    1912738774,
    1750109898,
    1891544029,
    1356180939,
    1285983734,
    1376893131,
    1801131859,
    1053657296,
    1104241975,
    1790105989,
    1649689712,
    1023532280,
    1770092793,
    1689188906,
    1851890115,
    1831698190,
    1902194038,
    1245910439,
    1841972288,
    1497533319,
    1386423457,
    1306520283,
    1225607187,
    1497428213,
    1437235199,
    1851477558,
    1750467452,
    1417033119,
    1013449115,
    1558895961,
    1265834246,
    1992277552,
    1467004507,
    1821641432,
    1407591167,
    1932814373,
    1619674272,
    1457053027,
    1538861653,
    1417613407,
    1447916333,
    1649921610,
    1770294407,
    1235842568,
    1548297195,
    1124053947,
    1861419426,
    1306034475,
    1184805400,
    1174704837,
    1386703270,
    1205999133,
    1447492582,
    1306071527,
    1457583890,
    1588854061,
    1124003587,
    1447367453,
    1497104871,
    1093268203,
    1285182030,
    1467901470,
    1124563325,
    1225576176,
    1366880601,
    1922437649,
    1346679537,
    1811474828,
    1316421258,
    1710461322,
    1891384079,
    1073198099,
    1316573934,
    1558979278,
    1679039929,
    1982161774,
    1598227225,
    1477198117,
    1912544081,
    1679105027,
    1679541098,
    1508825175,
    1215990510,
    1548224413,
    1447261243,
    1043215759,
    1063456846,
    1326250036,
    1487120572,
    1508332438,
    1558834762,
    1558834671,
    1669937934,
    1538626536,
    1386107738,
    1750844015,
    1093379786,
    1790347185,
    1609423078,
    1447800529,
    1134770357,
    1518595339,
    1497534085,
    1790551307,
    1962017848,
    1649887431,
    1528668175,
    1033607817,
    1235618851,
    1043922578,
    1538898911,
    1275269490,
    1588179345,
    1477851038,
    1780970335,
    1689008534,
    1942019690,
    1811709884,
    1699367649,
    1225622459,
    1568047587,
    1053996611,
    1093483349,
    1689497323,
    1346080405,
    1720363732,
    1962020958,
    1093323982,
    1316610132,
    1306519129,
    1417621475,
    1427615871,
    1346790946,
    1003699240,
    1962190892,
    1447336185,
    1699851337,
    1932200995,
    1679625214,
    1285763383,
    1033234315,
    1801098470,
    1457554131,
    1306024237,
    1659328805,
    1588606008,
    1639313661,
    1982697629,
    1790771004,
    1699703041,
    1720003262,
    1649542143,
    1598084386,
    1730492760,
    1619382850,
    1306254560,
    1578097937,
    1194252650,
    1669992731,
    1740706332,
    1790024859,
    1396085981,
    1710308101,
    1447677828,
    1629498571,
    1649520735,
    1780936815,
    1275877748,
    1083950463,
    1801133228,
    1902143878,
    1184961732,
    1811391592,
    1891095451,
    1609179928,
    1912204512,
    1255369435,
    1497782817,
    1548298839,
    1629177324,
    1649370339,
    1235215930,
    1639525470,
    1982157012,
    1821546623,
    1114475944,
    1184109118,
    1609695592,
    1285442566,
    1790590214,
    1861149387,
    1235870825,
    1063158855,
    1275256679,
    1205665866,
    1770314593,
    1215651716,
    1902523764,
    1154038867,
    1558078923,
    1477262590,
    1972814424,
    1174062210,
    1588266571,
    1922601335,
    1578228839,
    1053004770,
    1851084909,
    1174205694,
    1942061791,
    1407606387,
    1639920119,
    1265283790,
    1326897158,
    1851131130,
    1073509105,
    1417944513,
    1801887419,
    1174715718,
    1821031329,
    1073779260,
    1063667905,
    1336152230,
    1386707552,
    1629129390,
    1306990072,
    1437310588,
    1992818801,
    1922119247,
    1992802813,
    1215990098,
    1790734341,
    1013311968,
    1962892414,
    1821480799,
    1780970475,
    1659643286,
    1104198118,
    1467793000,
    1497181960,
    1689266710,
    1033701164,
    1497349435,
    1134701196,
    1487237525,
    1609411669,
    1336785914,
    1518590280,
    1457971921,
    1619587110,
    1902418031,
    1457966509,
    1285164780,
    1114437100,
    1376056366,
    1154826261,
    1821023649,
    1346550100,
    1063225795,
    1174352827,
    1710252135,
    1205261138,
    1992957229,
    1972693190,
    1841372984,
    1033292529,
    1083130686,
    1841054467,
    1982462545,
    1033978648,
    1649030313,
    1427805696,
    1083496996,
    1609645944,
    1730941428,
    1851951909,
    1053967430,
    1881240653,
    1821633801,
    1881079242,
    1073981239,
    1346611084,
    1710342589,
    1942902879,
    1598441446,
    1679987804,
    1992110597,
    1740913227,
    1063146561,
    1710388301,
    1508055708,
    1255417994,
    1871679571,
    1417033168,
    1548499940,
    1336850429,
    1568178408,
    1629774187,
    1386340628,
    1831777440,
    1104544162,
    1134871742,
    1225610280,
    1851961924,
    1851066963,
    1801562459,
    1720755077,
    1437817053,
    1184661126,
    1588619639,
    1841341500,
    1679778419,
    1134327927,
    1306916416,
    1346309242,
    1336203306,
    1164684304,
    1679000376,
    1588184659,
    1871832121,
    1801415351,
    1912528084,
    1841806841,
    1164038535,
    1982924635,
    1346552783,
    1811209208,
    1376034389,
    1154809408,
    1457647943,
    1205111952,
    1548736630,
    1700353547,
    1679047492,
    1104382092,
    1043776842,
    1285232777,
    1881294395,
    1790388007,
    1881281970,
    1588256614
  )
)
